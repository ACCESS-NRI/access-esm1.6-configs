# This is a typical input file for OASIS 3.0, using netCDF format
# for restart input files.  Oasis reads this file at run-time. 
#
# Any line beginning with # is ignored. Blank lines are not allowed.
#
# unused in mct $SEQMODE
# This keyword concerns the coupling algorithm. Put here the maximum number
# of fields that have to be, at one particular coupling timestep,
# necessarily exchanged sequentially in a given order.
#       1
# $END
#########################################################################
# unused in mct $CHANNEL
# The communication technique you want to use.
# Choices are MPI1 or MPI2, NONE, SIPC, GMEM.
# - if you use MPI1 or MPI2 message passing (CLIM library based on
# MPI1 or MPI2), you must write MPI1 or MPI2 on one line 
# + one line per model giving for the model the total number of procs,
# the number of procs implied in the coupling and, for MPI2 only, an
# optional launching argument
#
# #Channel
# #Mod1procs 
# #Mod2procs
# #Mod3procs
# $END
#########################################################################
 $NFIELDS
# This is the total number of fields being exchanged. 
### 26 fields  atm -> ice
### 15 fields  ice -> ocn
###  7 fields  ocn -> ice
### 18 fields  ice -> atm
   74 
 $END
#########################################################################
# unused in mct $JOBNAME
# This is an acronym for this run.
# (3 characters)
#   OIA
# $END
##########################################################################
#  $NBMODEL
# This gives you the number of models running in this experiment +
# their names (character*6, exactly!) + , in option, the maximum Fortran unit
# number used by each model; 1024 will be used if none are given.
#
#   3    um7.3x    mom5xx    cicexx   99  99  99
#  $END
###########################################################################
 $RUNTIME
# This gives you the total simulated time for this run in seconds 
#
#   86400    ! 1  day
# 2678400    ! 31 days
 86400
#  $END
###########################################################################
# unused in mct $INIDATE
# This is the initial date of the run. This is important only if
# FILLING analysis is used for a coupling field in the run.
# The format is YYYYMMDD such as 19910101
# #Inidate
# $END
###########################################################################
# unused in mct $MODINFO
# Indicates if a header is encapsulated within the field brick 
# in binary restart files for all communication techniques, and  
# for coupling field exchanges for PIPE, SIPC and GMEM.
# (YES or NOT)
#  NOT
# $END
###########################################################################
 $NLOGPRT
# Index of printing level in output file cplout: 0 = no printing
#  1 = main routines and field names when treated, 2 = complete output
# Set to 0 for oasis3-mct v2.0
# 0
# oa3-mct v5.0 has multiple options for this
# $NLOGPRT: The first, second and third numbers on the line below this keyword refer to (i) the
# debug verbosity, (ii) internal timing statistics and (iii) component load balancing analysis. The
# information is written by OASIS3-MCT for each component and (optionnally) for each process.
# The first number (that can be modified at runtime with the oasis set debug routine, see section
# 2.2.9) may be:
# – 0 : production mode. One file debug.root.xx is open by the master process of each component
# and one file debug notroot.xx is open for all the other processes of each component to write
# only error information.
# – 1 : one file debug.root.xx is open by the master process of each component to write informa-
# tion equivalent to level 10 (see below) and also to write memory usage information; one file
# debug notroot.xx is open for all the other processes of each component to write error informa-
# tion.
# – 2 : one file debug.yy.xxxxxx is open by each process of each component (with “yy” being the
# component number and “xxxxxx” the process number) to write normal production diagnostics
# and memory usage information
# – 5 : as for 2 with in addition some initial debug info
# – 10: as for 5 with in addition the routine calling tree
# – 12: as for 10 with in addition some routine calling notes
# – 15: as for 12 with even more debug diagnostics
# – 20: as for 15 with in addition some extra runtime analysis
# – 30: full debug information
# The second number defines how time statistics are written out to file comp name.timers xxxx (with
# comp name being the component name, see section 2.2.2); it can be:
# – 0 : nothing is calculated or written.
# – 1 : some time statistics are calculated and written in a single file by the processor 0 as well as
# the min and the max times over all the processors.
# – 2 : some time statistics are calculated and each processor writes its own file ; processor 0 also
# writes the min and the max times over all the processors in its file.
# – 3 : some time statistics are calculated and each processor writes its own file ; processor 0 also
# writes in its file the min and the max times over all processors and also writes in its file all the
# results for each processor.
# For more information on the time statistics written out, see section 6.4.2.
# The third number (new in OASIS3-MCT 5.0) can be set to 1 to activate a load balancing diagnostic.
# An efficient use of the allocated computing resources in a coupled system requires the harmonisation
# of the components speed. This operation, called load balancing, is often neglected, either because of
# the apparent resource abundance and practical difficulties. To facilitates this work, OASIS3-MCT
# can output the full timeline of all coupling related events, for any of the allocated resources. This
# timeline is saved in one netCDF file per coupled component (timeline XXX component.nc).
# It provides the comprehensive sequence of any operations related to the coupling (field exchange
# through MPI, field output on disk, field interpolation and mapping, field reading on disk, restart
# writing, initialisation and termination phase of the OASIS3-MCT setup) so that any simulation slow
# down in link with the use of the OASIS library can be identified. The analysis of the coupling
# field exchanges, amongst all the coupling events, allows not only to identify the resources waste of
# components which are recurrently waiting for their coupling fields but it also reveals other bottle-
# necks such as disk access, OS interruptions or model internal load imbalance. The full picture of
# these events makes possible an optimum load balancing, even for the most complex configurations.
# For a detailed information on load balancing analysis and timeline visualisation see respectively
# [Maisonnave et al 2020] and in [Piacentini and Maisonnave 2020]. In addition to the timeline, com-
# puting information (time to solution, speed, cost) and a synthesis of the time spent on MPI routines
# for each coupled component can also help, in the simpler cases, to allocate resources in a balanced
# way ( see file load balancing info.txt ).
 0 0 0
#  $END
###########################################################################
 $NCDFTYP
# Optional (new in OASIS3-MCT 5.0); on the line below this keyword is a character
# string that indicates the NetCDF file type for all (i.e. mapping, restart, output) new NetCDF files
# generated by OASIS3. The options are cdf1, cdf2, and cdf5. The mode cdf1 is also known as
# classic mode, cdf2 as large file format or 64bit offset and supports larger files, cdf5 as 64bit data
# and supports both larger files and larger variables. More information about these file types can be
# found in NetCDF documentation. Because cdf5 may not be generally available in all NetCDF
# installations, use of this option requires that the C preprocessor directive CDF 64BIT DATA be
# used when compiling OASIS3-MCT. If that preprocessor is not used, cdf5 is not a valid option.
# The file format for any NetCDF file can be diagnosed by using “ncdump -k filename”. $NCDFTYP
# only affects new files created by OASIS3-MCT. NetCDF will read and/or overwrite existing files of
# any NetCDF file type, and the file type will remain unchanged in that case
  cdf2
#  $END
###########################################
# $NNOREST: Optional (new in OASIS3-MCT 4.0); on the line below this keyword is a character
# string that can override the requirement that restart files must exist if they are needed. If the character
# string value starts with T, t, .T, or .t (as in true), then OASIS3-MCT will initialise with zero any
# variable that normally requires a restart (for instance, variables with LAG > 0) if the restart file does
# not exist. By default, missing restart files will cause the model to abort. It is strongly recommended
# that this keyword NOT be used in production runs. It exists to provide a quick shortcut for running
# technical tests. Note that if $NNOREST is true but the restart file nonetheless exists, it will be used.
$NNOREST
  T
###########################################
$SEQMODE
$CHANNEL
$JOBNAME
$NBMODEL
$INIDATE
$MODINFO
$CALTYPE
###########################################################################
# unused in mct  $CALTYPE
# Calendar type :  0      = 365 day calendar (no leap years)
#                  1      = 365 day, or 366 days for leap years, calendar
#                  n (>1) = n day month calendar
# This is important only if FILLING analysis is used for a coupling
# field in the run.
#
# #Caltype
# $END
###########################################################################
 $STRINGS
#
# The above variables are the general parameters for the experiment.
# Everything below has to do with the fields being exchanged.
#
############################################################################
# --- note file cf_name_table.txt does not include all the coupling flds ---
# --- listed below. so the fld number (367 for swfld etc) may not point  ---
# --- to the realistic 'longname' of the variable. (may modify this file ---
# --- to add more fields in the future.) 
############################################################################
#
#                      ATMOSPHERE  --->>>  ICE
#                      -----------------------
# -- 01:02:..:18
heatflux:pen_sol:lhflx:tmlt01:tmlt02:tmlt03:tmlt04:tmlt05:bmlt01:bmlt02:bmlt03:bmlt04:bmlt05:swflx:lwflx:shflx:press:co2_a thflx_i:pswflx_i:lhflx_i:tmlt01_i:tmlt02_i:tmlt03_i:tmlt04_i:tmlt05_i:bmlt01_i:bmlt02_i:bmlt03_i:bmlt04_i:bmlt05_i:swflx_i:lwflx_i:shflx_i:press_i:co2_ai 1 10800 4 a2i.nc EXPORTED
192 145 360 300 um1t cice LAG=+1800 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 19:20:21:22:23
runoff:wme:train:tsnow:evap2d runoff_i:wme_i:rain_i:snow_i:evap_i 1 10800 4 a2i.nc EXPORTED
192 145 360 300 um1t cice LAG=+1800 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 DESTAREA FIRST
INT=0
# -- 19: 
taux taux_i 23 10800 4 a2i.nc EXPORTED
192 145 360 300 um1u cice LAG=+1800 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 20: 
tauy tauy_i 24 10800 4 a2i.nc EXPORTED
192 144 360 300 um1v cice LAG=+1800 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 26: 
wnd_a wnd_ai 33 10800 4 a2i.nc EXPORTED
192 144 360 300 um1v cice LAG=+1800 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
############################################################################
#
#                      ICE --->>> OCEAN
#                      ----------------
##########
# Field 01 : ice-ocean interface stress (x-direction)
##########
strsu_io u_flux 170 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 02 : ice-ocean interface stress (y-direction)
##########
strsv_io v_flux 175 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 03 : freshwater flux -- rainfall (+ice melting?) 
##########
rain_io lprec 27 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 04 : freshwater flux -- snowfall
##########
snow_io fprec 28 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 05 : salt flux   (no ref no for saltflux yet!)
##########
stflx_io salt_flx 454 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 06 : next heat flux   (heatflux into ocean. '42' not right.)
##########
htflx_io mh_flux 42 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 07 : swflux penetrating through ice into ocean 
##########
swflx_io sw_flux 367 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 08 : latent heat flux
##########
qflux_io q_flux 452 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 09 : Sensible heat flux
##########
shflx_io t_flux 362 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 10 : LW radiation flux down
##########
lwflx_io lw_flux 366 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 11 : runoff
########## 
runof_io runof 297 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 12 : surface pressure
########## 
press_io p 33 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 13 : surface pressure
########## 
aice_io aice 44 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 14 : ice melting waterflux
##########
melt_io wfimelt 36 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 15 : ice forming waterflux
##########
form_io wfiform 36 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 16 : co2
########## 
co2_i1 co2_io 44 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 17 : 10m wind speed
########## 
wnd_i1 wnd_io 44 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 18 : land ice discharge waterflux
########## 
lice_fw licefw 44 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 19 : land ice discharge heatflux
########## 
lice_ht liceht 44 3600 1 i2o.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
############################################################################
# 
#                      OCEAN --->>> ICE
#                      ----------------
########## 
# Field 01 : Sea surface temperature (Celsius in MOM4)
##########
t_surf sst_i 1 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#  
LOCTRANS
INSTANT
########## 
# Field 02 : Sea surface salinity (psu)
##########
s_surf sss_i 312 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#  
LOCTRANS
INSTANT
##########
# Field 03 :  'eastward' sea surface water velocity
########## 
u_surf ssu_i 181 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
########## 
# Field 04 : 'northward' sea surface water velocity
##########
v_surf ssv_i 261 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 05 :  frazil ice fromation energy (J/m^2) 
#             ('441' is "upward_sea_ice_basal_heat_flux' 'W m-2')
##########
#pfmice_oi pfmice_i 441 3600 1 o2i.nc IGNORED
frazil pfmice_i 441 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 06 :  sea surface slope _x_ (m/m)
#             ( '203' is "height" ...)
##########
dssldx sslx_i 203 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 07 :  sea surface slope _y_ (m/m)
#             ( '310' is "sea_surface_elevation")
########## 
dssldy ssly_i 310 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 08 :  co2 (??)
#             ( co2 )
########## 
co2_o co2_oi 310 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
##########
# Field 09 :  co2 flux (??)
#             ( co2 flux )
########## 
co2fx_o co2fx_oi 310 3600 1 o2i.nc IGNORED
cice cice LAG=0 SEQ=+1
#
LOCTRANS
INSTANT
############################################################################
#
#                      ICE --->>> ATMOSPHERE
#                      ---------------------
# -- 01:
isst_ia ocn_sst 1 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 02:
icecon01:icecon02:icecon03:icecon04:icecon05 ofrzn01:ofrzn02:ofrzn03:ofrzn04:ofrzn05 31 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 07:
snwthk01:snwthk02:snwthk03:snwthk04:snwthk05 osnwtn01:osnwtn02:osnwtn03:osnwtn04:osnwtn05 373 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 12:
icethk01:icethk02:icethk03:icethk04:icethk05 ohicn01:ohicn02:ohicn03:ohicn04:ohicn05 468 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 17:
uvel_ia sunocean 47 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1u LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 18:
vvel_ia svnocean 48 10800 4 i2a.nc EXPORTED
360 300 192 144 cice um1v LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 19:
co2_i2 co2_ia 1 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
# -- 20:
co2fx_i2 co2fx_ia 31 10800 4 i2a.nc EXPORTED
360 300 192 145 cice um1t LAG=+3600 SEQ=+1
P 0 P 0
#
LOCTRANS CHECKIN SCRIPR CHECKOUT
INSTANT
INT=0
CONSERV LR SCALAR LATLON 10 FRACNNEI FIRST
INT=0
############################################################################
 $END
